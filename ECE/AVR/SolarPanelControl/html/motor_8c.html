<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Tiny261 Solar Tracker: C:/Users/Robert/Documents/Atmel Studio/SolarPanelControl/SolarPanelControl/motor.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tiny261 Solar Tracker
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Sends and receives data to and from the computer and moves a motor with a connected solar panel accordingly.  Also possesses the ability to find the position of the motor that gives the solar panel the most light.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_f64893e36f8c31d4c59df75761de097c.html">Robert</a></li><li class="navelem"><a class="el" href="dir_4d3d6b1b26f4b3c1d1a5f5a1fa4552ed.html">Documents</a></li><li class="navelem"><a class="el" href="dir_3cd17d5f66484117ab1da0fcbf108e07.html">Atmel Studio</a></li><li class="navelem"><a class="el" href="dir_da4d5c64fde85053b91adebd02d0da1c.html">SolarPanelControl</a></li><li class="navelem"><a class="el" href="dir_f60b6179a4e54f27225b99bfa3e362f3.html">SolarPanelControl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">motor.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="motor_8h_source.html">motor.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a152258e18f402ebe927fc4cb17fae6b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a152258e18f402ebe927fc4cb17fae6b4">set_motor_forward</a> ()</td></tr>
<tr class="separator:a152258e18f402ebe927fc4cb17fae6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9bb01f60c9a57f6d251597912be29ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#ad9bb01f60c9a57f6d251597912be29ed">set_motor_reverse</a> ()</td></tr>
<tr class="separator:ad9bb01f60c9a57f6d251597912be29ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb7178ac5b7a527492c8e0d7809d7023"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#afb7178ac5b7a527492c8e0d7809d7023">set_motor_stop</a> ()</td></tr>
<tr class="separator:afb7178ac5b7a527492c8e0d7809d7023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a111cb64a6a8eb205e36d716cec623255"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a111cb64a6a8eb205e36d716cec623255">set_direction</a> (int direction)</td></tr>
<tr class="separator:a111cb64a6a8eb205e36d716cec623255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f8ea0aff2df3daa82f6df80097030a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#ae4f8ea0aff2df3daa82f6df80097030a">move_motor</a> (int dir)</td></tr>
<tr class="separator:ae4f8ea0aff2df3daa82f6df80097030a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931ac6113e667fae40a88c57b3a34590"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a931ac6113e667fae40a88c57b3a34590">get_error</a> (uint8_t destination)</td></tr>
<tr class="separator:a931ac6113e667fae40a88c57b3a34590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac524aad536dda17079baf68a2a4b164"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#aac524aad536dda17079baf68a2a4b164">update_servo_position</a> (uint8_t destination)</td></tr>
<tr class="separator:aac524aad536dda17079baf68a2a4b164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ada0aef69dd0c5c9834c040e82c4340"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a8ada0aef69dd0c5c9834c040e82c4340">set_servo_position</a> (uint8_t destination, uint16_t seekTime)</td></tr>
<tr class="separator:a8ada0aef69dd0c5c9834c040e82c4340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0974fff7d31aea408f21aebefbf173"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motor_8c.html#a2a0974fff7d31aea408f21aebefbf173">enable_PWM</a> ()</td></tr>
<tr class="separator:a2a0974fff7d31aea408f21aebefbf173"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Robert L. Phillips III </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.1</dd></dl>
<h1><a class="anchor" id="LICENSE"></a>
LICENSE</h1>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</p>
<h1><a class="anchor" id="DESCRIPTION"></a>
DESCRIPTION</h1>
<p>Includes functions for setting up PWM on PB5 and controlling the motor that is to have a solar panel mounted on it</p>
<h1><a class="anchor" id="HARDWARE"></a>
HARDWARE</h1>
<p>Target Device: ATTINY261 </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2a0974fff7d31aea408f21aebefbf173"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enable_PWM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enables fast PWM on PB5 </p>

</div>
</div>
<a class="anchor" id="a931ac6113e667fae40a88c57b3a34590"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_error </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>destination</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the error in the motor position by comparing the current position of the motor to the destination that is supplied</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">destination</td><td>The destination (between 0 and 255) that the servo motor is to move</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The difference between the destination and current motor position</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="adc_8h.html#ace17af43b64b290289a2d7477cc45c0b">ADC_REF_VCC</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a5cd2c638c2d03f35a615a209652b60ce">POT_ADC</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a2d37d1eb5ea11e4dbc41c369421c2e45">UPPER_BOUND</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a44b4de4784f751e71fad94edd351ff41">LOWER_BOUND</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ae4f8ea0aff2df3daa82f6df80097030a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void move_motor </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Moves the motor in the supplied direction or stops the motor if the stop command is given</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>The direction that the motor is to move in</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="motor_8h.html#abe61b07c31c2a3e90576eb4c5d95b024">CW</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a8a460b6555077a64fc97f2e7ef47b843">CCW</a> </dd>
<dd>
<a class="el" href="motor_8h.html#ae19b6bb2940d2fbe0a79852b070eeafd">STOP</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a3021d8a488052ab8915ddae99f8bfa22">PWMD</a> </dd>
<dd>
<a class="el" href="motor_8h.html#ae2af80213d699a79be05671a827beaed">SERVO_SPEED</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a111cb64a6a8eb205e36d716cec623255"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_direction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the motor direction to spin in the supplied direction</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>The direction that the motor is to spin in</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="motor_8h.html#a6ddfdda7a062d10cff4a72b76b44aeb8">FORWARD</a> </dd>
<dd>
<a class="el" href="motor_8h.html#a00548cec6d104932bf79a65bac1c47e8">REVERSE</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a152258e18f402ebe927fc4cb17fae6b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_motor_forward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the motor direction to spin in the forward direction </p>

</div>
</div>
<a class="anchor" id="ad9bb01f60c9a57f6d251597912be29ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_motor_reverse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the motor direction to spin in the reverse direction </p>

</div>
</div>
<a class="anchor" id="afb7178ac5b7a527492c8e0d7809d7023"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_motor_stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the motor to stop </p>

</div>
</div>
<a class="anchor" id="a8ada0aef69dd0c5c9834c040e82c4340"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_servo_position </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>seekTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Moves the motor as close to the desired destination that it can get before the timeout expires</p>
<p>If 0 is given as the destination, the motor will retain its current position. This is meant to be used when the computer wants to get the solar panel measurements without moving the motor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">destination</td><td>The desired destination (between 0 and 255) </td></tr>
    <tr><td class="paramname">seekTime</td><td>The max time the motor can take to reach its destination</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="motor_8h.html#a02a2dcde419161a54d0c8c994e2424cc">SERVO_POSITION_TIMEOUT</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aac524aad536dda17079baf68a2a4b164"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_servo_position </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>destination</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines which direction the motor needs to spin in order for the motor to get closer to its destination and moves the motor accordingly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">destination</td><td>The desired destination (between 0 and 255) of the motor</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="motor_8h.html#a196c194bd32527a119ac607d3b2330b6">DEADBAND</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 22 2012 23:10:36 for Tiny261 Solar Tracker by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
